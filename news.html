<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>CitySeer News</title>

    <!-- adding 3 stylesheets: reset.css, bootstrap, and style.css -->
    <!-- <link rel="stylesheet" type="text/css" href="assets/css/reset.css" /> -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <!-- <link rel="stylesheet" type="text/css" href="assets/css/style.css" /> -->

        <!-- Font Awesome CSS Icons (For cool glyphicons) -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
        <script src="https://code.jquery.com/jquery.js"></script>
        <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>
      
  </head>







  <body>
    <!-- box structure includes a main container (mainContainer class), a menu (topNavMenu class), and a content container (mainContentContainer) for overview, top events, and pictures content -->
    <div class="mainContainer">
        <header>
            <div class="topNavMenu">
              <nav
                class="navbar navbar-expand-lg navbar navbar-dark bg-dark">
                <a class="navbar-brand" href="index.html"
                  ><img
                    src="assets/images/smalllogo.png"
                    alt="back to search"
                    style="width:50px;height:50px;"
                /></a>
                <button
                  class="navbar-toggler"
                  type="button"
                  data-toggle="collapse"
                  data-target="#navbarText"
                  aria-controls="navbarText"
                  aria-expanded="false"
                  aria-label="Toggle navigation"
                >
                  <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarText">
                  <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                      <a class="nav-link" href="overview.html"
                        >About this City</a
                      >
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="news.html">Local News<span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="events.html">Local Events</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="topcities.html">Top Searched Cities</a>
                      </li>
                  </ul>
                  <!-- <span id="fireBase">Firebase Placeholder</span> -->
                  <span id="currentCityID"></span>
                  <span class="navbar-text">
                    &nbsp;  &nbsp;
                  </span>
                  <span id="currentWeather"></span>
                </div>


                <div class="container">
                  <div class="row">
                    <div class="col-6"></div>
                  </div>
              
                  <!-- Row for Searching New York Times -->
                  
                    <div class="col-sm-6">
                      <br>
                      <!-- First card is for handling the search parameters -->
                        <div class="card-body">
              
                          <!-- Here we create an HTML Form for handling the inputs-->
                          <form role="form">
              
                            <!-- Here we create the text box for capturing the search term-->
                            <div class="form-group">
                              <input type="text" class="form-control" id="search-term">
                            </div>
              
              
                            <!-- Here we have our final submit button -->
                            <button type="submit" class="btn btn-warning" id="run-search">
                              <i class="fa fa-search"></i> Search</button>
                            <button class="btn btn-secondary" id="clear-all">
                              <i class="fa fa-trash"></i> Clear Results</button>
              
                          </form>
                        </div>
                      
                    </div>
              
                </div>
              </nav>
            </div>
          </header>


          
          <body background="http://wanderers.mikado-themes.com/wp-content/uploads/2018/02/h1-background-1.png">
          
            <!-- Temporary Article Bootstrap Search -->
            
          
          
          
          
          
            <br>
          
            <!-- Articles will load in a table of 3 -->
          
          
            <div class="row">
          
              <!-- Bootstrap Grid Divided 9 : 3 -->
              <div class="col-2"></div>
          
              <div class="col-7">
                <div class="card-header">
                  <h2 class="cityname"><strong>
                      <i class="headline"></i>    New York Times Travel Articles</strong></h2>
                  
          
                  <div class="row" style=padding-left:30px id="display-articles"> 
        
                  </div>
          

          
          
                  <!-- Load More Button 
                  <div id="divLoadButton"></div>
                  <button read-more="" type="button" class="btn btn-warning" id="divLoadButton"><i class="fa fa-newspaper-o"></i>
                    Load More</button>
                </div>-->
                  <br><br>
          
                <footer id="divLoadButton"></footer>
                  </div>
          
          
                <div class="col-3"></div>
              </div>
            </div>
          
          
          
          
          
            <script src="https://code.jquery.com/jquery.js"></script>
            <script type="text/javascript">
          
          
              function buildQueryURL() {
                // queryURL is the url we'll use to query the API
                var queryURL = "https://api.nytimes.com/svc/search/v2/articlesearch.json?";
          
                // Begin building an object to contain our API call's query parameters
                // Set the API key
                var queryParams = { "api-key": "gEHdwjN6FzvV3qyy6BpAlyGyU4m9NGGP" };
          
          
                // Grab text the user typed into the search input, add to the queryParams object
                queryParams.q = $("#search-term")
                  .val()
                  .trim();
          
                queryParams.fq = ("news_desk:travel");
          
                //console.log(queryParams.q);
                return queryURL + $.param(queryParams);
          
          
          
          
              }
          
          
              function updatePage(NYTData) {
                // Get from the form the number of results to display
                // API doesn't have a "limit" parameter, so we have to do this ourselves
                var numArticles = 20;
          
                console.log(numArticles);
          
                // Log the NYTData to console, where it will show up as an object
                console.log(NYTData);
                console.log("------------------------------------");
          
                // Loop through and build elements for the defined number of articles
                for (var i = 0; i < numArticles; i++) {
                  // Get specific article info for current index
                  var article = NYTData.response.docs[i];
          
          
          
          
          
                  // Create the  group to contain the articles and add the article content for each
                  var $articleList = $("<div>");
                  $articleList.append("<br>");
          
          
          
          
          
          
                  // Add the newly created element 
                  $("#display-articles").append($articleList);
                  //$("#article-section4").append(articleGrid);
          
                  // If the article has a headline, log and append to $articleList
                  var headline = article.headline;
          
                  //("#display-gifs").append(topicDiv);
                  //var $articleListItem = $("<th scope='col'></th>");
                    //var $articleListItem = $("<th scope='col'></th>");
                  var $articleListItem = $("<div style='background-color:white; padding:35px;  width:500px; height:625px; margin: auto;'></div>");
                
          
                  
          
          
          
          
          
          
                  var multimedia = ("http://nyt.com/" + article.multimedia[i].url);
                  console.log(multimedia);
          
                  var image = $("<img>");
                    image.attr('height', 300);
                  //image.attr('maxWidth', 400);
                  
                  

                  image.attr("src", multimedia);
                  //image.attr("'<ime class='img-responsive img-thumbnail'>");
          
          
                  // Appending the paragraph and image tag to the animalDiv
                  if (multimedia) {
                    $articleListItem.append(image);
                  }
          

                  if (headline && headline.main) {
                    console.log(headline.main);
                    $articleListItem.append(
                      "<span class='label label-primary'>" +
                      "</span>" +
                      "<h4> " +
                      headline.main +
                      "</h4>"
                    );
                    ;
                  }
          
          
          
          
          
          
          
                  // If the article has a byline, log and append to $articleList
                  var byline = article.byline;
          
                  if (byline && byline.original) {
                    console.log(byline.original);
                    $articleListItem.append("<h6>" + byline.original + "</h6>");
                  }
          
          
                  // Log published date, and append to document if exists
                  var pubDate = article.pub_date;
                  console.log(pubDate);
          
                  //Using momen.js to convert date format
                  var randomFormat = "YYYY-MM-DD";
                  var convertedDate = moment(pubDate, randomFormat);
                  var date = convertedDate.format("MMMM Do, YYYY");
          
          
                  if (pubDate) {
                    $articleListItem.append("<h6>" + date + "</h6>");
                  }
          
          
                  // Log published date, and append to document if exists
          
                  var snippet = article.snippet;
                  console.log(snippet);
                  if (snippet) {
                    $articleListItem.append("<p>" + snippet + "<p>");
                  }
          
          
          
          
                  var articleButton = $("<button>");
          
          
                  articleButton.addClass("btn btn-warning");
                  articleButton.addClass("fa fa-newspaper-o");
                  articleButton.text(" " + "Read Article");
                  var articleLink = $("<a>");
                  articleLink.attr("href", article.web_url);
                  articleLink.append(articleButton);
                  // articleButton.append("<a href='" + article.web_url + "'>" + article.web_url + "</a>");
                  console.log(article.web_url);
                  $articleListItem.append(articleLink);
                  // $(articleLink).clone().appendTo("#user-button");
                  $articleList.append($articleListItem);
          
                  //var articleGrid = $('<div>');
                  //articleGrid.addClass("col-sm-4"[i])
                  //articleGrid.append($articleList);
          
                }
          
                  // Function to load more articles
          
          
                var load = document.createElement("button");
                load.setAttribute('id', "divLoadButton");
                load.innerHTML = "Load More";
                $("#divLoadButton").empty();
                $("#divLoadButton").append(load);
          
                $("#divLoadButton").on("click", function () {
          
                  numArticles = numArticles + 3;
                  console.log(numArticles);
                  //i=i+10;
                  console.log(i);
                  //Load
          
          
          
          })
          
          
          
              }
          
              
              
          
          
          
          
          
          
              // Function to empty out the articles
              function clear() {
                $("#article-section4").empty();
              }
          
          
              $("#run-search").on("click", function (event) {
                event.preventDefault();
                clear();
          
          
                var queryURL = buildQueryURL();
                $.ajax({
                  url: queryURL,
                  method: "GET"
                }).then(updatePage);
              });
          
          
              $("#clear-all").on("click", clear);
          
          
          
          
          
            </script>
          
          </body>
          
          </html>
          
          
          
          
   
          
          
          
